{
    "content": "metadata = {\n    'protocolName': 'DNA Dilution with CSV File',\n    'author': 'Rami Farawi <rami.farawi@opentrons.com>',\n    'source': 'Custom Protocol Request',\n    'apiLevel': '2.11'\n}\n\n\ndef get_values(*names):\n    import json\n    _all_values = json.loads(\"\"\"{ \"csv\":\"\",\n                        \"p300_mount\":\"left\",\n                                  \"p20_mount\":\"right\"}\"\"\")\n    return [_all_values[n] for n in names]\n\n\ndef run(ctx):\n\n    [csv, p20_mount, p300_mount] = get_values(  # noqa: F821\n        \"csv\", \"p20_mount\", \"p300_mount\")\n\n    # labware\n    reservoir = ctx.load_labware('nest_1_reservoir_195ml', '1')\n    final_plate = ctx.load_labware('nest_96_wellplate_100ul_pcr_full_skirt', '2')  # noqa: E501\n    dna_plate = ctx.load_labware('nest_96_wellplate_100ul_pcr_full_skirt', '3')  # noqa: E501\n    tiprack20 = [ctx.load_labware('opentrons_96_filtertiprack_20ul', slot)\n                 for slot in ['4', '5']]\n    tiprack300 = [ctx.load_labware('opentrons_96_filtertiprack_200ul', '6')]\n\n    # instruments\n    p20 = ctx.load_instrument('p20_single_gen2', p20_mount, tip_racks=tiprack20)  # noqa: E501\n    p300 = ctx.load_instrument('p300_single_gen2', p300_mount, tip_racks=tiprack300)  # noqa: E501\n\n    # csv --> nested list\n    list_of_rows = [[val.strip() for val in line.split(',')]\n                    for line in csv.splitlines()\n                    if line.split(',')[0].strip()][1:]\n\n    # mapping\n    source_well_loc = 1\n    dest_well_loc = 8\n    dna_vol_loc = 3\n    water_vol_loc = 4\n\n    ctx.comment('\\n\\nTRANSFERRING WATER\\n')\n    for line in list_of_rows:\n        dest_well = line[dest_well_loc].replace(\"0\", \"\") if line[dest_well_loc][1] == \"0\" else line[dest_well_loc]  # noqa: E501\n        dest = final_plate.wells_by_name()[dest_well]\n        water_vol = float(line[water_vol_loc])\n\n        pip = p20 if water_vol < 20 else p300\n\n        pip.pick_up_tip()\n        pip.transfer(water_vol, reservoir.wells()[0], dest, new_tip='never')\n        pip.drop_tip()\n\n    ctx.comment('\\n\\nTRANSFERRING DNA\\n')\n    for line in list_of_rows:\n        source_well = line[source_well_loc].replace(\"0\", \"\") if line[source_well_loc][1] == \"0\" else line[source_well_loc]  # noqa: E501\n        dest_well = line[dest_well_loc].replace(\"0\", \"\") if line[dest_well_loc][1] == \"0\" else line[dest_well_loc]  # noqa: E501\n        source = dna_plate.wells_by_name()[source_well]\n        dest = final_plate.wells_by_name()[dest_well]\n        dna_vol = float(line[dna_vol_loc])\n\n        pip = p20 if water_vol < 20 else p300\n\n        pip.pick_up_tip()\n        pip.transfer(dna_vol, source, dest, new_tip='never')\n        pip.drop_tip()\n",
    "custom_labware_defs": [],
    "fields": [
        {
            "default": "Extraction Plate/Box,Well Location,DNA Concentration,DNA Input (uL),NFW Input (uL),Total Dilution Volume (uL),Dilution Concentration (ng/uL),Final Plate Location,Well Location\nDNA Plate 1,A01,6.03,2,13.08,15.08,0.8,DNA Dilution Plate 1,A01",
            "label": ".CSV File",
            "name": "csv",
            "type": "textFile"
        },
        {
            "label": "P20 Single-Channel Mount",
            "name": "p20_mount",
            "options": [
                {
                    "label": "Right",
                    "value": "right"
                },
                {
                    "label": "Left",
                    "value": "left"
                }
            ],
            "type": "dropDown"
        },
        {
            "label": "P300 Single-Channel Mount",
            "name": "p300_mount",
            "options": [
                {
                    "label": "Left",
                    "value": "left"
                },
                {
                    "label": "Right",
                    "value": "right"
                }
            ],
            "type": "dropDown"
        }
    ],
    "instruments": [
        {
            "mount": "left",
            "name": "p300_single_gen2"
        },
        {
            "mount": "right",
            "name": "p20_single_gen2"
        }
    ],
    "labware": [
        {
            "name": "NEST 1 Well Reservoir 195 mL on 1",
            "share": false,
            "slot": "1",
            "type": "nest_1_reservoir_195ml"
        },
        {
            "name": "NEST 96 Well Plate 100 \u00b5L PCR Full Skirt on 2",
            "share": false,
            "slot": "2",
            "type": "nest_96_wellplate_100ul_pcr_full_skirt"
        },
        {
            "name": "NEST 96 Well Plate 100 \u00b5L PCR Full Skirt on 3",
            "share": false,
            "slot": "3",
            "type": "nest_96_wellplate_100ul_pcr_full_skirt"
        },
        {
            "name": "Opentrons 96 Filter Tip Rack 20 \u00b5L on 4",
            "share": false,
            "slot": "4",
            "type": "opentrons_96_filtertiprack_20ul"
        },
        {
            "name": "Opentrons 96 Filter Tip Rack 20 \u00b5L on 5",
            "share": false,
            "slot": "5",
            "type": "opentrons_96_filtertiprack_20ul"
        },
        {
            "name": "Opentrons 96 Filter Tip Rack 200 \u00b5L on 6",
            "share": false,
            "slot": "6",
            "type": "opentrons_96_filtertiprack_200ul"
        },
        {
            "name": "Opentrons Fixed Trash on 12",
            "share": false,
            "slot": "12",
            "type": "opentrons_1_trash_1100ml_fixed"
        }
    ],
    "metadata": {
        "apiLevel": "2.11",
        "author": "Rami Farawi <rami.farawi@opentrons.com>",
        "protocolName": "DNA Dilution with CSV File",
        "source": "Custom Protocol Request"
    },
    "modules": []
}