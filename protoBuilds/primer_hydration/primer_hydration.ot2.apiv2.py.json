{
    "content": "metadata = {\n    'protocolName': 'Multiple Primer hydration',\n\t'description': 'Used to transfer water from 15mL falcon tube to 2mL tubes. Uses multi-channel as single-channel. \\\n\t\tPipette will reuse tips. Also make sure to decrease\\\n\t\t\t\t   pipette current',\n    'apiLevel': '2.8'\n    }\n### DECREASE THE CURRENT FOR PICKING UP TIPS TO 0.1amps\n##Normal is at0.8amps\n\nimport csv\nfrom typing import Dict\nfrom opentrons import protocol_api\nfrom opentrons import types\nimport numpy as np\n\ndef run (protocol:protocol_api.ProtocolContext):\n\tp300_multi:protocol_api.InstrumentContext\n\tprotocol.pause('Ensure pipette current is decreased from 0.8Amps (normal) to 0.1Amps to avoid damaging the pipette when it picks up tips.')\n\t#Define tips\n\ttiprack_300 = protocol.load_labware('opentrons_96_tiprack_300ul', '4')\n\n\t#Define labware\n\tholder_falcon = protocol.load_labware('opentrons_10_tuberack_falcon_4x50ml_6x15ml_conical', '5')##DO NOT MOVE TO slots 1-2-3 because you won't be able to access bottom tubes\n\tholder_tube = protocol.load_labware('opentrons_24_tuberack_generic_2ml_screwcap', '6')##DO NOT MOVE TO slots 1-2-3 because you won't be able to access bottom tubes\n\t\n\t\n\t#Define instruments and assign tips\n\tp300_multi = protocol.load_instrument('p300_multi_gen2', 'right')\n\tp300_multi.flow_rate.aspirate = 150\n\tp300_multi.flow_rate.dispense = 50\n\n\t[csv_raw] = get_values( #noqa: F821\n\t\t'volume_transfers')\n\t## Expected csv file \n# \tcsv_raw = '''\n# source_well,destination_well,transfer_volume\n# A1,A1,546\n# A1,A2,700\n# A1,A3,300\n# A1,A4,300\n# A1,A4,100\n# A1,A5,255\n# A1,A6,267\n# A2,D6,250\n# '''\n\t#csv parsing\n\tcsv_data = csv_raw.splitlines()[1:]  # Discard the blank first line.\n\tcsv_reader = csv.DictReader(csv_data,fieldnames=['source_well','destination_well','transfer_volume'])\n\t\n\t#validation (since we are using 15mL falcon tubes, we want the transfer volume to not surpass 5mL)\n\tmax_cumulative_volume = 5000\n\tcum_volumes = {}\n\tfor csv_row in (csv_reader):\n\t\tsource_well = csv_row['source_well']\n\t\ttransfer_volume = float(csv_row['transfer_volume'])\n\t\tif source_well not in cum_volumes:\n\t\t\tcum_volumes[source_well] = 0\n\t\tcum_volumes[source_well] += transfer_volume\n\t\tif cum_volumes[source_well] > max_cumulative_volume: #ensure cumulative volume is less than 5mL\n\t\t\traise Exception(f\"Cumulative volume from well {source_well} should not surpass {str(max_cumulative_volume)}. \\\n\t\t\tAdd more falcon tubes and modify csv.\")\n\t\n\t#start protocol\n\tp300_multi.pick_up_tip(tiprack_300[\"H1\"])\n\tfor csv_row in (csv_reader):\n\t\tsource_well = csv_row['source_well']\n\t\tdestination_well = csv_row['destination_well']\n\n\t\tvolume_left_to_transfer= float(csv_row['transfer_volume'])\n\t\twhile(volume_left_to_transfer>0):\n\t\t\ttransfer_volume = min(p300_multi.max_volume,volume_left_to_transfer)\n\t\t\tvolume_left_to_transfer-=transfer_volume\n\t\t\tp300_multi.move_to(holder_falcon.wells_by_name()[source_well].top(z=0))\n\t\t\tp300_multi.aspirate(transfer_volume, holder_falcon.wells_by_name()[source_well].top(z=-40))\n\t\t\tp300_multi.move_to(holder_falcon.wells_by_name()[source_well].top())\n\t\t\tp300_multi.move_to(holder_tube.wells_by_name()[destination_well].top())\n\t\t\tp300_multi.dispense(transfer_volume, holder_tube.wells_by_name()[destination_well].top(z=-15))\n\t\t\tprotocol.delay(seconds=0.5)\n\t\t\tp300_multi.blow_out(holder_tube.wells_by_name()[destination_well].top())\n\n\tp300_multi.drop_tip()\n\treturn\n\n",
    "custom_labware_defs": [],
    "fields": [
        {
            "default": "source_well,destination_well,transfer_volume\nA1,A1,546\nA1,A2,700\nA1,A3,300\nA1,A4,300\nA1,A4,100\nA1,A5,255\nA1,A6,267\nA2,D6,250",
            "label": "Volume Transfers",
            "name": "volume_transfers",
            "type": "textFile"
        }
    ],
    "instruments": [
        {
            "mount": "right",
            "name": "p300_multi_gen2"
        }
    ],
    "labware": [
        {
            "name": "Opentrons 96 Tip Rack 300 \u00b5L on 4",
            "share": false,
            "slot": "4",
            "type": "opentrons_96_tiprack_300ul"
        },
        {
            "name": "Opentrons 10 Tube Rack with Falcon 4x50 mL, 6x15 mL Conical on 5",
            "share": false,
            "slot": "5",
            "type": "opentrons_10_tuberack_falcon_4x50ml_6x15ml_conical"
        },
        {
            "name": "Opentrons 24 Tube Rack with Generic 2 mL Screwcap on 6",
            "share": false,
            "slot": "6",
            "type": "opentrons_24_tuberack_generic_2ml_screwcap"
        },
        {
            "name": "Opentrons Fixed Trash on 12",
            "share": false,
            "slot": "12",
            "type": "opentrons_1_trash_1100ml_fixed"
        }
    ],
    "metadata": {
        "apiLevel": "2.8",
        "description": "Used to transfer water from 15mL falcon tube to 2mL tubes. Uses multi-channel as single-channel. \t\tPipette will reuse tips. Also make sure to decrease\t\t\t\t   pipette current",
        "protocolName": "Multiple Primer hydration"
    },
    "modules": []
}