{
    "content": "metadata = {\n    'protocolName': 'qPCR Prep in Triplicates',\n    'author': 'Rami Farawi <rami.farawi@opentrons.com>',\n    'source': 'Custom Protocol Request',\n    'apiLevel': '2.11'\n}\n\n\ndef run(ctx):\n\n    [num_samp, final_plate_slot3, control_plate,\n     p20_mount, p300_mount] = get_values(  # noqa: F821\n        \"num_samp\", \"final_plate_slot3\",\n        \"control_plate\", \"p20_mount\", \"p300_mount\")\n\n    num_samp = int(num_samp)\n\n    # load labware\n    final_plate = ctx.load_labware(final_plate_slot3, '4')\n    mastermix_rack = ctx.load_labware(\n                    'opentrons_24_aluminumblock_generic_2ml_screwcap', '1')\n    dna_samples = ctx.load_labware(\n                  'opentrons_96_aluminumblock_generic_pcr_strip_200ul', '7')\n    control_plate = ctx.load_labware(control_plate, '9')\n\n    tiprack200 = [ctx.load_labware('opentrons_96_tiprack_300ul', '10')]\n    tiprack20 = [ctx.load_labware('opentrons_96_tiprack_20ul', '11')]\n\n    # load instrument\n    m20 = ctx.load_instrument('p20_multi_gen2', p20_mount,\n                              tip_racks=tiprack20)\n    p300 = ctx.load_instrument('p300_multi_gen2', p300_mount,\n                               tip_racks=tiprack200)\n\n    # PROTOCOL\n    num_cols = int(num_samp/8)\n    final_wells = final_plate.rows()[0][::3]\n    final_wells_single_chan = [well for col in final_plate.columns()[::3]\n                               for well in col]\n\n    # distribute mastermix\n    mastermix = mastermix_rack.wells()[0]\n    p300.pick_up_tip()\n    for i, well in enumerate(final_wells_single_chan[:num_samp+8]):\n        p300.aspirate(48, mastermix, rate=0.75)\n        ctx.delay(2)\n        p300.dispense(24, mastermix, rate=0.75)\n        p300.aspirate(24, mastermix, rate=0.75)\n        ctx.delay(2)\n        p300.dispense(48, well, rate=0.75)\n        ctx.delay(1)\n        p300.blow_out()\n        if i % 7 == 0 and i > 0:\n            p300.drop_tip()\n            p300.pick_up_tip()\n            ctx.comment('\\n')\n    ctx.comment('\\n\\n\\n')\n\n    # distribute sample to mastermix\n    airgap = 3\n    for s_col, d_col in zip(dna_samples.rows()[0][:num_cols], final_wells):\n        m20.pick_up_tip()\n        m20.aspirate(12, s_col)\n        m20.touch_tip()\n        m20.air_gap(airgap)\n        m20.dispense(12+airgap, d_col)\n        m20.touch_tip()\n        m20.blow_out()\n        m20.drop_tip()\n    ctx.comment('\\n\\n\\n')\n\n    # add control\n    control = control_plate.rows()[0][-1]\n    m20.pick_up_tip()\n    m20.aspirate(12, control)\n    m20.dispense(12, final_wells[3])\n    m20.drop_tip()\n    ctx.comment('\\n\\n\\n')\n\n    for i, column in enumerate(final_wells[:num_cols+1]):\n        m20.pick_up_tip()\n        m20.mix(5, 20, column)\n        m20.blow_out()\n        m20.aspirate(20, column)\n        m20.dispense(20, final_plate.rows()[0][i*3+1])\n        m20.blow_out()\n        m20.aspirate(20, column)\n        m20.dispense(20, final_plate.rows()[0][i*3+2])\n        m20.blow_out()\n        m20.drop_tip()\n",
    "custom_labware_defs": [],
    "fields": [
        {
            "label": "Number of Samples (not including controls)",
            "name": "num_samp",
            "options": [
                {
                    "label": "8",
                    "value": "8"
                },
                {
                    "label": "16",
                    "value": "16"
                },
                {
                    "label": "24",
                    "value": "24"
                }
            ],
            "type": "dropDown"
        },
        {
            "label": "Final Plate Labware Type",
            "name": "final_plate_slot3",
            "options": [
                {
                    "label": "MicroAmp 96-well plate with support base",
                    "value": "biorad_96_wellplate_200ul_pcr"
                },
                {
                    "label": "Tube-strips with support base",
                    "value": "biorad_96_wellplate_200ul_pcr"
                }
            ],
            "type": "dropDown"
        },
        {
            "label": "Control Plate Labware Type",
            "name": "control_plate",
            "options": [
                {
                    "label": "Tube strips with support base",
                    "value": "biorad_96_wellplate_200ul_pcr"
                },
                {
                    "label": "Tube-strips with 96-well aluminum block",
                    "value": "biorad_96_wellplate_200ul_pcr"
                }
            ],
            "type": "dropDown"
        },
        {
            "label": "P20 Multi-Channel Mount",
            "name": "p20_mount",
            "options": [
                {
                    "label": "Right",
                    "value": "right"
                },
                {
                    "label": "Left",
                    "value": "left"
                }
            ],
            "type": "dropDown"
        },
        {
            "label": "P300 Single-Channel Mount",
            "name": "p300_mount",
            "options": [
                {
                    "label": "Left",
                    "value": "left"
                },
                {
                    "label": "Right",
                    "value": "right"
                }
            ],
            "type": "dropDown"
        }
    ],
    "instruments": [
        {
            "mount": "left",
            "name": "p300_multi_gen2"
        },
        {
            "mount": "right",
            "name": "p20_multi_gen2"
        }
    ],
    "labware": [
        {
            "name": "Opentrons 24 Well Aluminum Block with Generic 2 mL Screwcap on 1",
            "share": false,
            "slot": "1",
            "type": "opentrons_24_aluminumblock_generic_2ml_screwcap"
        },
        {
            "name": "Bio-Rad 96 Well Plate 200 \u00b5L PCR on 4",
            "share": false,
            "slot": "4",
            "type": "biorad_96_wellplate_200ul_pcr"
        },
        {
            "name": "Opentrons 96 Well Aluminum Block with Generic PCR Strip 200 \u00b5L on 7",
            "share": false,
            "slot": "7",
            "type": "opentrons_96_aluminumblock_generic_pcr_strip_200ul"
        },
        {
            "name": "Bio-Rad 96 Well Plate 200 \u00b5L PCR on 9",
            "share": false,
            "slot": "9",
            "type": "biorad_96_wellplate_200ul_pcr"
        },
        {
            "name": "Opentrons 96 Tip Rack 300 \u00b5L on 10",
            "share": false,
            "slot": "10",
            "type": "opentrons_96_tiprack_300ul"
        },
        {
            "name": "Opentrons 96 Tip Rack 20 \u00b5L on 11",
            "share": false,
            "slot": "11",
            "type": "opentrons_96_tiprack_20ul"
        },
        {
            "name": "Opentrons Fixed Trash on 12",
            "share": false,
            "slot": "12",
            "type": "opentrons_1_trash_1100ml_fixed"
        }
    ],
    "metadata": {
        "apiLevel": "2.11",
        "author": "Rami Farawi <rami.farawi@opentrons.com>",
        "protocolName": "qPCR Prep in Triplicates",
        "source": "Custom Protocol Request"
    },
    "modules": []
}