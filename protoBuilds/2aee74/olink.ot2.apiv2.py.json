{
    "content": "import math\n\nmetadata = {\n    'protocolName': 'Olink Target 96 Part 1/3: Incubation',\n    'author': 'Nick <ndiehl@opentrons.com>',\n    'description': 'Custom Protocol Request',\n    'apiLevel': '2.11'\n}\n\n\ndef run(ctx):\n\n    num_samples, p300_mount, m20_mount = get_values(  # noqa: F821\n        'num_samples', 'p300_mount', 'm20_mount')\n\n    if not 1 <= num_samples <= 96:\n        raise Exception('Invalid number of samples (1-96)')\n\n    inc_mix = ctx.load_labware('opentrons_24_tuberack_nest_1.5ml_screwcap',\n                               '4',\n                               'tuberack for incubation mix (A1)').wells()[0]\n    inc_plate = ctx.load_labware('nest_96_wellplate_100ul_pcr_full_skirt', '2',\n                                 'incubation plate')\n    sample_plate = ctx.load_labware('nest_96_wellplate_100ul_pcr_full_skirt',\n                                    '5', 'sample plate')\n    strip = ctx.load_labware('nest_96_wellplate_100ul_pcr_full_skirt', '1',\n                             'strip for distribution (column 1)').columns()[0]\n    tipracks300 = [ctx.load_labware('opentrons_96_tiprack_300ul', '6')]\n    tipracks20 = [ctx.load_labware('opentrons_96_tiprack_20ul', '3')]\n\n    p300 = ctx.load_instrument('p300_single_gen2', p300_mount,\n                               tip_racks=tipracks300)\n    m20 = ctx.load_instrument('p20_multi_gen2', m20_mount,\n                              tip_racks=tipracks20)\n\n    num_cols = math.ceil(num_samples/8)\n\n    # transfer incubation mix to strip with reverse pipetting\n    p300.pick_up_tip()\n    p300.aspirate(20, inc_mix)\n    for well in strip:\n        p300.aspirate(47, inc_mix)\n        p300.dispense(47, well)\n    p300.dispense(p300.current_volume, inc_mix)\n    p300.drop_tip()\n\n    # transfer from strip to plate\n    m20.pick_up_tip()\n    m20.aspirate(2, strip[0])\n    for col in inc_plate.rows()[0][:num_cols]:\n        m20.aspirate(3, strip[0])\n        m20.dispense(3, col)\n    m20.dispense(m20.current_volume, strip[0])\n    m20.home()\n\n    # transfer samples\n    for s, d in zip(sample_plate.rows()[0][:num_samples],\n                    inc_plate.rows()[0][:num_samples]):\n        if not m20.has_tip:\n            m20.pick_up_tip()\n        m20.transfer(1, s, d, new_tip='never')\n        m20.drop_tip()\n\n    ctx.comment('Seal the plate with an adhesive plastic film, spin at 400 x \\\ng, 1 min at room temperature. Incubate overnight at +4\u00b0C.')\n",
    "custom_labware_defs": [],
    "fields": [
        {
            "default": 96,
            "label": "number of samples (1-96)",
            "name": "num_samples",
            "type": "int"
        },
        {
            "label": "P300 single-channel pipette mount",
            "name": "p300_mount",
            "options": [
                {
                    "label": "left",
                    "value": "left"
                },
                {
                    "label": "right",
                    "value": "right"
                }
            ],
            "type": "dropDown"
        },
        {
            "label": "P20 multi-channel pipette mount",
            "name": "m20_mount",
            "options": [
                {
                    "label": "right",
                    "value": "right"
                },
                {
                    "label": "left",
                    "value": "left"
                }
            ],
            "type": "dropDown"
        }
    ],
    "instruments": [
        {
            "mount": "left",
            "name": "p300_single_gen2"
        },
        {
            "mount": "right",
            "name": "p20_multi_gen2"
        }
    ],
    "labware": [
        {
            "name": "strip for distribution (column 1) on 1",
            "share": false,
            "slot": "1",
            "type": "nest_96_wellplate_100ul_pcr_full_skirt"
        },
        {
            "name": "incubation plate on 2",
            "share": false,
            "slot": "2",
            "type": "nest_96_wellplate_100ul_pcr_full_skirt"
        },
        {
            "name": "Opentrons 96 Tip Rack 20 \u00b5L on 3",
            "share": false,
            "slot": "3",
            "type": "opentrons_96_tiprack_20ul"
        },
        {
            "name": "tuberack for incubation mix (A1) on 4",
            "share": false,
            "slot": "4",
            "type": "opentrons_24_tuberack_nest_1.5ml_screwcap"
        },
        {
            "name": "sample plate on 5",
            "share": false,
            "slot": "5",
            "type": "nest_96_wellplate_100ul_pcr_full_skirt"
        },
        {
            "name": "Opentrons 96 Tip Rack 300 \u00b5L on 6",
            "share": false,
            "slot": "6",
            "type": "opentrons_96_tiprack_300ul"
        },
        {
            "name": "Opentrons Fixed Trash on 12",
            "share": false,
            "slot": "12",
            "type": "opentrons_1_trash_1100ml_fixed"
        }
    ],
    "metadata": {
        "apiLevel": "2.11",
        "author": "Nick <ndiehl@opentrons.com>",
        "description": "Custom Protocol Request",
        "protocolName": "Olink Target 96 Part 1/3: Incubation"
    },
    "modules": []
}